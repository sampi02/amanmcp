# v0.1.65 - MLX Server Integration

**Release Date:** 2026-01-09

---

## Added

- **MLX Server Integration**: Bundle MLX embedding server in `mlx-server/` directory (ADR-035)
  - 55x faster embeddings than Ollama on Apple Silicon
  - Models stored in `~/.amanmcp/models/mlx/` (consistent with other AmanMCP data)
  - Default port changed to 9659 (avoid conflicts with common port 8000)
  - Auto-detection on Apple Silicon with fallback to Ollama
  - Three model sizes: small (1024d), medium (2560d), large (4096d)

## Changed

- **MLX default port**: Changed from 8000 to 9659 to avoid conflicts with common dev servers

## Documentation

- **MLX documentation updates**:
  - Add MLX to README.md tech stack and quick start
  - Add MLX setup option to first-time-user-guide.md (Step 1)
  - Add MLX configuration section to configuration.md
  - Add MLX troubleshooting section to first-time-user-guide.md
  - Create ADR-035-mlx-default-embedder.md
- Create ROADMAP.md - executive summary of strategic roadmap (what next)
- Create VALIDATION.md - test queries and success criteria (how to verify)
- Simplify EXECUTION.md from 186 to 106 lines (what now)
- Reorganize docs/ into clear hierarchy:
  - docs/getting-started/ - introduction, system requirements
  - docs/reference/ - architecture, decisions, specs, user-commands, glossary
  - docs/development/ - workflow, validation, release checklist
- Archive 126 resolved items to archive/:
  - 51 resolved bugs (docs/bugs/ → archive/bugs/)
  - 16 resolved tech debt (archive/tech-debt/)
  - 16 postmortems (archive/postmortems/)
  - 43 old changelog files (archive/changelog/v0.1/)
- Move misplaced files: SYSTEM_REQUIREMENTS.md, AUTO-REINDEXING.md
- Delete redundant WORK.md (superseded by EXECUTION.md)
- Final simplification:
  - Archive dogfood.md, strategic-improvements-2026.md, mlx-plan
  - Consolidate 6 checklists into 3 (before-work, after-work, checkpoint)
  - Archive 20+ changelog version files
  - Expand ROADMAP.md to be THE roadmap (180 lines, all 27 items)
  - Expand VALIDATION.md to be THE validation doc (172 lines)
- Create RCA-012 documentation sprawl analysis with best practices

---

## Files Added

| File | Purpose |
|------|---------|
| `mlx-server/server.py` | MLX embedding server (port 9659) |
| `mlx-server/requirements.txt` | Python dependencies |
| `mlx-server/README.md` | Setup instructions |
| `mlx-server/LICENSE` | MIT license (attribution to jakedahn) |
| `docs/reference/decisions/ADR-035-mlx-default-embedder.md` | Architecture decision record |

## Files Modified

| File | Change |
|------|--------|
| `internal/embed/mlx.go` | Default port → 9659 |
| `internal/embed/mlx_test.go` | Updated test expectations |
| `internal/embed/factory.go` | Updated comment |
| `internal/config/config.go` | Default port → 9659 |
| `README.md` | MLX in tech stack, quick start |
| `docs/guides/first-time-user-guide.md` | MLX setup option, troubleshooting |
| `docs/reference/configuration.md` | MLX config section |

---

## Usage

### MLX Server (Apple Silicon - Recommended)

```bash
# Start MLX server
cd mlx-server
python3 -m venv .venv && source .venv/bin/activate
pip install -r requirements.txt
python server.py  # Port 9659, downloads model on first run

# Verify
curl http://localhost:9659/health
```

### Configuration

```yaml
# config.yaml
embeddings:
  provider: mlx
  mlx_endpoint: http://localhost:9659
  mlx_model: large  # small, medium, or large
```

```bash
# Environment variables
AMANMCP_EMBEDDER=mlx
AMANMCP_MLX_ENDPOINT=http://localhost:9659
AMANMCP_MLX_MODEL=large
```
