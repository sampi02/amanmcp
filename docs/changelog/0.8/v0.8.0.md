# v0.8.0 - Black Box Architecture

**Released:** 2026-01-14

This release introduces modular, testable indexing and search components following Eskil Steenberg's Black Box Design principles.

---

## Added

- **pkg/indexer**: New package for modular indexing components (FEAT-BB2, FEAT-BB3, FEAT-BB4)
  - `Indexer` interface for pluggable indexing backends
  - `BM25Indexer` wrapping `store.BM25Index` with clean API
  - `VectorIndexer` wrapping `embed.Embedder` + `store.VectorStore` (FEAT-BB3)
  - `HybridIndexer` composing BM25 + Vector for hybrid search (FEAT-BB4)
  - Thread-safe concurrent access with mutex protection
  - 69 unit tests with mocked dependencies (19 BM25 + 21 Vector + 29 Hybrid)
- **pkg/searcher**: New package for modular search components (FEAT-BB5)
  - `Searcher` interface with `Search(ctx, query, limit) ([]Result, error)`
  - `BM25Searcher` for lexical search via BM25 algorithm
  - `VectorSearcher` for semantic search with query embedding (Qwen3 prefix)
  - `FusionSearcher` combining BM25 + Vector using RRF algorithm
  - Graceful degradation: partial failures return working searcher's results
  - 41 unit tests with mocked dependencies (9 BM25 + 13 Vector + 19 Fusion)

## Changed

- **internal/validation**: Make validation queries data-driven (Unix Philosophy)
  - Move hardcoded queries to `testdata/queries.yaml` - no rebuild required to modify
  - Add `LoadQueries()` function with runtime loading and caching
  - Queries now support `notes` field for maintainer documentation
  - Exclude `internal/validation/**` from indexing to prevent self-referential pollution

## Documentation

- Add ADR-038: Black Box Indexer and Searcher Architecture
- Add Validation Testing Guide (`docs/guides/validation-testing.md`)
  - Documents data-driven query system
  - Explains how to add/modify validation queries without rebuild
  - Covers troubleshooting and design decisions

---

## Statistics

- **110 new tests** (69 indexer + 41 searcher)
- **Coverage:** 65.1%
- **Sprint:** 7 (Bug Fixes + Architecture Foundation)

---

## Upgrade Notes

No breaking changes. The new `pkg/indexer` and `pkg/searcher` packages are additive and do not affect existing functionality.
